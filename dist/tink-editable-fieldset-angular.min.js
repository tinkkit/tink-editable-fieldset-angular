/*! tink-editable-fieldset-angular v0.1.0-beta.1 */
"use strict";!function(module){try{module=angular.module("tink.fieldset")}catch(e){module=angular.module("tink.fieldset",[])}module.directive("tinkFieldset",["safeApply","$timeout","$compile",function(safeApply,$timeout,$compile){return{restrict:"A",priority:0,scope:{valuesChanged:"=",tinkFormEditable:"="},require:"form",compile:function(template){return $(template).find("select").on("mousedown",function(){console.log("ok")}),{pre:function(){},post:function(scope,element,attr){function disabledAtStart(){getElements().each(function(index,elem){($(elem).attr("disabled")||$(elem).scope().isDisabled)&&disabledReady.push($(elem).get(0))})}function setClassActive(cssClass){cssClass!==activeClass&&($(element).removeClass(activeClass),$(element).addClass(cssClass),activeClass=cssClass)}function specialElementsFix(element,enable){$(element).is("select")&&elementSelectFix(element,enable)}function elementSelectFix(element,enable){if(enable)element.css("display","block"),element.next().is("input")&&element.next().remove();else{element.css("display","none");var model=element.attr("ng-model")||element.attr("data-ng-model"),input=$('<input type="text" disabled ng-model="'+model+'"/>');input=$compile(input)(scope.$parent),input.insertAfter(element)}}function isDisabled(elem){var targetEl=$(elem),isDisabled=targetEl.attr("disabled")||targetEl.attr("data-disabled")||targetEl.attr("is-disabled");return isDisabled?!0:!1}function mouseOverEvent(e,elem){safeApply(scope,function(){activeClass===classToSetWhenActive||isDisabled(e.target)||setClassActive(classToSetWhenOnHover)})}function mouseOutEvent(e,elem){safeApply(scope,function(){activeClass===classToSetWhenActive||isDisabled(e.target)||setClassActive(classToSetWhenDefault)})}function blurEvent(e,elem){safeApply(scope,function(){$timeout(function(){initSerialize!==getSerializeObject()?scope.valuesChanged=!0:scope.valuesChanged=!1,focus=0,setClassActive(classToSetWhenDefault)},0)})}function focusEvent(){safeApply(scope,function(){$timeout(function(){focus=1,setClassActive(classToSetWhenActive)},0)})}function getSerializeObject(){for(var serialize={},i=elementWithMouseOver.length-1;i>=0;i--){var value,ngModel=$(elementWithMouseOver[i]).attr("ng-model")||$(elementWithMouseOver[i]).attr("data-ng-model");value=$(elementWithMouseOver[i]).scope().$eval(ngModel)?$(elementWithMouseOver[i]).scope().$eval(ngModel):""!==value?$(elementWithMouseOver[i]).val():"",serialize[i]=value}return JSON.stringify(serialize)}function getElements(){var mouseElements=element.find("[ng-model], [data-ng-model]");return mouseElements}function addMouseOverEvent(){getElements().each(function(index,elem){elementWithMouseOver.push(elem),$(elem).mouseover(elem,mouseOverEvent)})}function addMouseOutEvent(){getElements().each(function(index,elem){$(elem).mouseout(elem,mouseOutEvent)})}function addFocusEvent(){getElements().each(function(index,elem){$(elem).focusin(elem,focusEvent)})}function addBlurEvent(){getElements().each(function(index,elem){$(elem).focusout(elem,blurEvent)})}var disabledReady=[];disabledAtStart();var initSerialize,focus=0,elementWithMouseOver=[],classToSetWhenOnHover="mouseOver",classToSetWhenDefault="mouseOff",classToSetWhenActive="mouseFocus",cssUneditableClass="uneditable";setClassActive(classToSetWhenDefault);var activeClass="";scope.$watch("tinkFormEditable",function(value){value?($(template).addClass(cssUneditableClass),getElements().each(function(index,elem){safeApply(scope,function(){$(elem).isolateScope()&&($(elem).isolateScope().isDisabled=!0),$(elem).attr("disabled","true"),specialElementsFix($(elem),!1)})})):($(template).removeClass(cssUneditableClass),getElements().each(function(index,elem){-1===disabledReady.indexOf($(elem).get(0))&&safeApply(scope,function(){$(elem).isolateScope()&&($(elem).isolateScope().isDisabled=!1),$(elem).removeAttr("disabled"),specialElementsFix($(elem),!0)})}))}),$timeout(function(){addMouseOverEvent(),addMouseOutEvent(),addBlurEvent(),addFocusEvent(),initSerialize=getSerializeObject()},0)}}}}}])}();
//# sourceMappingURL=tink-editable-fieldset-angular.min.js.map